============================= test session starts ==============================
platform linux -- Python 3.11.11, pytest-7.4.3, pluggy-1.5.0 -- /home/juancho/anaconda3/bin/python3
cachedir: .pytest_cache
rootdir: /home/juancho/macgyver_mud
plugins: anyio-4.8.0, cov-4.1.0, Faker-37.1.0, time-machine-2.16.0
collecting ... collected 192 items

tests/test_agent_runtime.py::TestAgentRuntimeInit::test_init_with_session PASSED [  0%]
tests/test_agent_runtime.py::TestSelectSkill::test_select_skill_chooses_highest_score PASSED [  1%]
tests/test_agent_runtime.py::TestSelectSkill::test_select_skill_changes_with_belief PASSED [  1%]
tests/test_agent_runtime.py::TestSimulateSkill::test_simulate_peek_door_locked PASSED [  2%]
tests/test_agent_runtime.py::TestSimulateSkill::test_simulate_peek_door_unlocked PASSED [  2%]
tests/test_agent_runtime.py::TestSimulateSkill::test_simulate_try_door_unlocked PASSED [  3%]
tests/test_agent_runtime.py::TestSimulateSkill::test_simulate_try_door_locked PASSED [  3%]
tests/test_agent_runtime.py::TestSimulateSkill::test_simulate_go_window PASSED [  4%]
tests/test_agent_runtime.py::TestRunEpisode::test_run_episode_unlocked PASSED [  4%]
tests/test_agent_runtime.py::TestRunEpisode::test_run_episode_locked PASSED [  5%]
tests/test_agent_runtime.py::TestRunEpisode::test_run_episode_respects_max_steps PASSED [  5%]
tests/test_agent_runtime.py::TestRunEpisode::test_run_episode_logs_to_graph PASSED [  6%]
tests/test_agent_runtime.py::TestBehaviorPatterns::test_explores_when_uncertain PASSED [  6%]
tests/test_agent_runtime.py::TestBehaviorPatterns::test_exploits_when_confident PASSED [  7%]
tests/test_balanced_runner.py::TestGetSkills::test_get_skills_returns_list PASSED [  7%]
tests/test_balanced_runner.py::TestGetSkills::test_get_skills_includes_kind_field PASSED [  8%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_crisp_mode PASSED [  8%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_balanced_mode PASSED [  9%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_hybrid_mode PASSED [  9%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_invalid_mode_raises_error PASSED [ 10%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_with_empty_list PASSED [ 10%]
tests/test_balanced_runner.py::TestFilterSkillsByMode::test_filter_preserves_skill_properties PASSED [ 11%]
tests/test_balanced_runner.py::TestAgentRuntimeWithSkillMode::test_agent_runtime_accepts_skill_mode PASSED [ 11%]
tests/test_balanced_runner.py::TestAgentRuntimeWithSkillMode::test_agent_runtime_filters_skills_on_init PASSED [ 12%]
tests/test_balanced_runner.py::TestRunnerCommandLine::test_parse_args_accepts_skill_mode PASSED [ 13%]
tests/test_balanced_runner.py::TestRunnerCommandLine::test_parse_args_validates_skill_mode PASSED [ 13%]
tests/test_balanced_runner.py::TestRunnerCommandLine::test_parse_args_default_skill_mode PASSED [ 14%]
tests/test_balanced_runner.py::TestScoringIntegration::test_balanced_skill_scoring_has_both_components PASSED [ 14%]
tests/test_balanced_runner.py::TestScoringIntegration::test_agent_runtime_can_score_balanced_skills PASSED [ 15%]
tests/test_balanced_runner.py::TestBalancedSkillSimulation::test_balanced_skill_produces_observations PASSED [ 15%]
tests/test_balanced_runner.py::TestBalancedSkillSimulation::test_balanced_skill_updates_belief PASSED [ 16%]
tests/test_balanced_runner.py::TestEndToEnd::test_run_episode_with_crisp_mode PASSED [ 16%]
tests/test_balanced_runner.py::TestEndToEnd::test_run_episode_with_balanced_mode PASSED [ 17%]
tests/test_balanced_runner.py::TestEndToEnd::test_run_episode_with_hybrid_mode PASSED [ 17%]
tests/test_critical_states.py::test_flow_state PASSED                    [ 18%]
tests/test_critical_states.py::test_scarcity_state PASSED                [ 18%]
tests/test_critical_states.py::test_panic_state PASSED                   [ 19%]
tests/test_critical_states.py::test_deadlock_state PASSED                [ 19%]
tests/test_critical_states.py::test_novelty_state PASSED                 [ 20%]
tests/test_critical_states.py::test_hubris_state PASSED                  [ 20%]
tests/test_critical_states.py::test_priority_resolution PASSED           [ 21%]
tests/test_episode_logging.py::test_episode_logging PASSED               [ 21%]
tests/test_episodic_critical_fixes.py::test_path_tracking_is_populated PASSED [ 22%]
tests/test_episodic_critical_fixes.py::test_state_tracking_records_each_step PASSED [ 22%]
tests/test_episodic_critical_fixes.py::test_counterfactuals_require_labyrinth PASSED [ 23%]
tests/test_episodic_critical_fixes.py::test_counterfactuals_are_valid_with_labyrinth PASSED [ 23%]
tests/test_episodic_critical_fixes.py::test_offline_learning_improves_skill_selection PASSED [ 24%]
tests/test_episodic_critical_fixes.py::test_skill_priors_updated_after_replay PASSED [ 25%]
tests/test_episodic_critical_fixes.py::test_learning_rate_causes_meaningful_change PASSED [ 25%]
tests/test_episodic_critical_fixes.py::test_episodic_insights_propagate_to_procedural_memory PASSED [ 26%]
tests/test_episodic_critical_fixes.py::test_end_to_end_episodic_learning PASSED [ 26%]
tests/test_episodic_diagnostic.py::test_counterfactual_storage_retrieval PASSED [ 27%]
tests/test_episodic_integration.py::test_episodic_memory_disabled_by_default PASSED [ 27%]
tests/test_episodic_integration.py::test_episodic_memory_enabled PASSED  [ 28%]
tests/test_episodic_integration.py::test_episodic_memory_stores_episode PASSED [ 28%]
tests/test_episodic_integration.py::test_backward_compatibility_without_episodic PASSED [ 29%]
tests/test_episodic_memory.py::test_store_and_retrieve_episode PASSED    [ 29%]
tests/test_episodic_memory.py::test_store_counterfactuals PASSED         [ 30%]
tests/test_episodic_memory.py::test_regret_calculation PASSED            [ 30%]
tests/test_episodic_memory.py::test_counterfactual_generation PASSED     [ 31%]
tests/test_episodic_memory.py::test_offline_learning_improves_performance PASSED [ 31%]
tests/test_episodic_stress.py::test_overfitting_trap_stress_test PASSED  [ 32%]
tests/test_episodic_stress.py::test_regret_spiral_stress_test PASSED     [ 32%]
tests/test_episodic_stress.py::test_combined_stress_scenario PASSED      [ 33%]
tests/test_geometric_controller.py::test_baseline_preservation PASSED    [ 33%]
tests/test_geometric_controller.py::test_geometric_panic_mode PASSED     [ 34%]
tests/test_geometric_controller.py::test_geometric_flow_mode PASSED      [ 34%]
tests/test_geometric_controller.py::test_hysteresis PASSED               [ 35%]
tests/test_geometric_controller.py::test_memory_veto PASSED              [ 35%]
tests/test_graph_labyrinth.py::test_schema_initialization PASSED         [ 36%]
tests/test_graph_labyrinth.py::test_generate_linear_dungeon PASSED       [ 36%]
tests/test_graph_labyrinth.py::test_room_navigation PASSED               [ 37%]
tests/test_graph_labyrinth.py::test_distance_calculation PASSED          [ 38%]
tests/test_graph_labyrinth.py::test_visited_tracking PASSED              [ 38%]
tests/test_graph_labyrinth.py::test_labyrinth_stats PASSED               [ 39%]
tests/test_graph_labyrinth.py::test_clear_labyrinth PASSED               [ 39%]
tests/test_graph_labyrinth.py::test_backward_compatibility PASSED        [ 40%]
tests/test_graph_model.py::TestGetAgent::test_get_agent_exists PASSED    [ 40%]
tests/test_graph_model.py::TestGetAgent::test_get_agent_not_exists PASSED [ 41%]
tests/test_graph_model.py::TestGetInitialBelief::test_get_initial_belief PASSED [ 41%]
tests/test_graph_model.py::TestGetInitialBelief::test_get_belief_invalid_state_var PASSED [ 42%]
tests/test_graph_model.py::TestUpdateBelief::test_update_belief PASSED   [ 42%]
tests/test_graph_model.py::TestUpdateBelief::test_update_belief_multiple_times PASSED [ 43%]
tests/test_graph_model.py::TestGetSkills::test_get_skills_returns_list PASSED [ 43%]
tests/test_graph_model.py::TestGetSkills::test_get_skills_contains_required_fields PASSED [ 44%]
tests/test_graph_model.py::TestGetSkills::test_get_skills_contains_expected_skills PASSED [ 44%]
tests/test_graph_model.py::TestCreateEpisode::test_create_episode PASSED [ 45%]
tests/test_graph_model.py::TestCreateEpisode::test_create_multiple_episodes PASSED [ 45%]
tests/test_graph_model.py::TestLogStep::test_log_step PASSED             [ 46%]
tests/test_graph_model.py::TestLogStep::test_log_step_relationships PASSED [ 46%]
tests/test_graph_model.py::TestLogStep::test_log_multiple_steps PASSED   [ 47%]
tests/test_graph_model.py::TestLogStep::test_log_step_with_silver_stamp PASSED [ 47%]
tests/test_graph_model.py::TestLogStep::test_log_step_auto_builds_silver PASSED [ 48%]
tests/test_graph_model.py::TestLogStep::test_silver_stamp_json_structure PASSED [ 48%]
tests/test_integration.py::TestEpisodicProceduralDecisionFlow::test_episodic_learning_changes_skill_preferences PASSED [ 49%]
tests/test_integration.py::TestLyapunovEscalation::test_lyapunov_monitor_integration PASSED [ 50%]
tests/test_integration.py::TestLyapunovEscalation::test_lyapunov_does_not_crash_when_disabled PASSED [ 50%]
tests/test_integration.py::TestCriticalStatesGeometricController::test_panic_state_triggers_geometric_response PASSED [ 51%]
tests/test_integration.py::TestCriticalStatesGeometricController::test_scarcity_state_triggers_efficiency_mode PASSED [ 51%]
tests/test_integration.py::TestCriticalStatesGeometricController::test_deadlock_detection PASSED [ 52%]
tests/test_integration.py::TestEscalationProtocol::test_escalation_on_repeated_panic PASSED [ 52%]
tests/test_integration.py::TestEscalationProtocol::test_escalation_on_terminal_scarcity PASSED [ 53%]
tests/test_integration.py::TestFullSystemIntegration::test_agent_runs_with_all_features_enabled PASSED [ 53%]
tests/test_integration.py::TestFullSystemIntegration::test_agent_handles_failure_gracefully_with_all_features PASSED [ 54%]
tests/test_procedural_memory.py::TestSkillStats::test_initial_stats_empty PASSED [ 54%]
tests/test_procedural_memory.py::TestSkillStats::test_stats_update_increments_uses PASSED [ 55%]
tests/test_procedural_memory.py::TestSkillStats::test_context_specific_stats PASSED [ 55%]
tests/test_procedural_memory.py::TestSkillStats::test_success_rate_calculation PASSED [ 56%]
tests/test_procedural_memory.py::TestSkillStats::test_confidence_grows_with_samples PASSED [ 56%]
tests/test_procedural_memory.py::TestMetaParams::test_get_initial_meta_params PASSED [ 57%]
tests/test_procedural_memory.py::TestMetaParams::test_update_meta_params PASSED [ 57%]
tests/test_procedural_memory.py::TestMetaParams::test_partial_param_update PASSED [ 58%]
tests/test_procedural_memory.py::TestMetaParams::test_episode_count_tracking PASSED [ 58%]
tests/test_procedural_memory.py::TestRecentEpisodesStats::test_calculates_recent_performance PASSED [ 59%]
tests/test_procedural_memory.py::TestRecentEpisodesStats::test_limits_to_recent_episodes PASSED [ 59%]
tests/test_procedural_memory.py::TestRecentEpisodesStats::test_empty_when_no_episodes PASSED [ 60%]
tests/test_procedural_memory.py::TestIntegration::test_full_episode_with_memory_update PASSED [ 60%]
tests/test_procedural_memory.py::TestIntegration::test_context_sensitive_memory PASSED [ 61%]
tests/test_procedural_memory.py::TestMemoryScoring::test_no_memory_returns_theoretical PASSED [ 61%]
tests/test_procedural_memory.py::TestMemoryScoring::test_memory_bonus_positive_for_success PASSED [ 62%]
tests/test_procedural_memory.py::TestMemoryScoring::test_memory_penalty_for_failure PASSED [ 63%]
tests/test_procedural_memory.py::TestMemoryScoring::test_prefers_context_specific_stats PASSED [ 63%]
tests/test_procedural_memory.py::TestMemoryScoring::test_epistemic_bonus_for_underexplored PASSED [ 64%]
tests/test_procedural_memory.py::TestMemoryScoring::test_epistemic_decays_with_experience PASSED [ 64%]
tests/test_procedural_memory.py::TestMemoryScoring::test_score_all_skills_with_memory PASSED [ 65%]
tests/test_procedural_memory.py::TestMemoryScoring::test_explanation_contains_reasoning PASSED [ 65%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_agent_with_memory_updates_skill_stats PASSED [ 66%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_agent_without_memory_does_not_update_stats PASSED [ 66%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_agent_with_adaptive_params_increments_episodes PASSED [ 67%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_agent_adapts_meta_params_after_5_episodes PASSED [ 67%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_memory_influences_skill_selection PASSED [ 68%]
tests/test_procedural_memory.py::TestAgentRuntimeMemory::test_verbose_memory_includes_explanations PASSED [ 68%]
tests/test_schelling.py::test_schelling_placeholder SKIPPED (Schelli...) [ 69%]
tests/test_scoring.py::TestEntropy::test_entropy_boundary_zero PASSED    [ 69%]
tests/test_scoring.py::TestEntropy::test_entropy_boundary_one PASSED     [ 70%]
tests/test_scoring.py::TestEntropy::test_entropy_maximum_at_half PASSED  [ 70%]
tests/test_scoring.py::TestEntropy::test_entropy_symmetric PASSED        [ 71%]
tests/test_scoring.py::TestEntropy::test_entropy_monotonic_below_half PASSED [ 71%]
tests/test_scoring.py::TestEntropy::test_entropy_monotonic_above_half PASSED [ 72%]
tests/test_scoring.py::TestExpectedGoalValue::test_peek_door_no_goal_value PASSED [ 72%]
tests/test_scoring.py::TestExpectedGoalValue::test_try_door_increases_with_belief PASSED [ 73%]
tests/test_scoring.py::TestExpectedGoalValue::test_try_door_negative_when_likely_locked PASSED [ 73%]
tests/test_scoring.py::TestExpectedGoalValue::test_try_door_positive_when_likely_unlocked PASSED [ 74%]
tests/test_scoring.py::TestExpectedGoalValue::test_go_window_constant PASSED [ 75%]
tests/test_scoring.py::TestExpectedGoalValue::test_go_window_less_than_perfect_escape PASSED [ 75%]
tests/test_scoring.py::TestExpectedInfoGain::test_peek_door_info_gain_equals_entropy PASSED [ 76%]
tests/test_scoring.py::TestExpectedInfoGain::test_peek_door_max_info_at_half PASSED [ 76%]
tests/test_scoring.py::TestExpectedInfoGain::test_try_door_no_info_gain PASSED [ 77%]
tests/test_scoring.py::TestExpectedInfoGain::test_go_window_no_info_gain PASSED [ 77%]
tests/test_scoring.py::TestScoreSkill::test_score_at_uncertain_belief PASSED [ 78%]
tests/test_scoring.py::TestScoreSkill::test_score_at_high_belief_unlocked PASSED [ 78%]
tests/test_scoring.py::TestScoreSkill::test_score_at_low_belief_locked PASSED [ 79%]
tests/test_scoring.py::TestScoreSkill::test_score_uses_alpha_beta_gamma PASSED [ 79%]
tests/test_scoring.py::TestScoreSkill::test_score_monotonic_with_parameters PASSED [ 80%]
tests/test_scoring.py::TestEdgeCases::test_entropy_near_zero PASSED      [ 80%]
tests/test_scoring.py::TestEdgeCases::test_entropy_near_one PASSED       [ 81%]
tests/test_scoring.py::TestEdgeCases::test_unknown_skill_name PASSED     [ 81%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_harmonic_mean_basic PASSED [ 82%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_geometric_mean_basic PASSED [ 82%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_arithmetic_mean_basic PASSED [ 83%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_means_ordering_holds PASSED [ 83%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_harmonic_mean_imbalance_penalty PASSED [ 84%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_geometric_mean_balance PASSED [ 84%]
tests/test_scoring_silver.py::TestPythagoreanMeans::test_ensure_positive_clamps_negative PASSED [ 85%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_build_silver_stamp_returns_dict PASSED [ 85%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_build_silver_stamp_has_required_keys PASSED [ 86%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_build_silver_stamp_is_json_serializable PASSED [ 86%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_shape_coefficients_in_valid_range PASSED [ 87%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_silver_stamp_at_p_half PASSED [ 88%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_silver_stamp_at_p_high PASSED [ 88%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_silver_stamp_at_p_low PASSED [ 89%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_silver_score_reasonable_magnitude PASSED [ 89%]
tests/test_scoring_silver.py::TestBuildSilverStamp::test_silver_stamp_all_skills PASSED [ 90%]
tests/test_scoring_silver.py::TestShapeCoefficients::test_k_explore_balanced_when_goal_info_equal PASSED [ 90%]
tests/test_scoring_silver.py::TestShapeCoefficients::test_k_explore_low_when_imbalanced PASSED [ 91%]
tests/test_scoring_silver.py::TestShapeCoefficients::test_k_efficiency_reasonable PASSED [ 91%]
tests/test_scoring_silver.py::TestEdgeCases::test_zero_cost_handled PASSED [ 92%]
tests/test_scoring_silver.py::TestEdgeCases::test_extreme_belief_values PASSED [ 92%]
tests/test_scoring_silver.py::TestEdgeCases::test_all_numeric_values PASSED [ 93%]
tests/test_silent_issues.py::test_issue1_memory_veto_respects_scarcity_priority PASSED [ 93%]
tests/test_silent_issues.py::test_issue2_no_duplicate_boost_application PASSED [ 94%]
tests/test_silent_issues.py::test_issue3_distance_calculation_affects_scarcity PASSED [ 94%]
tests/test_silent_issues.py::test_issue4_boost_magnitude_consistency PASSED [ 95%]
tests/test_silent_issues.py::test_issue7_critical_state_tracking_reset_between_episodes PASSED [ 95%]
tests/test_silent_issues.py::test_issue8_steps_remaining_decrements_during_episode PASSED [ 96%]
tests/test_silent_issues.py::test_issue10_monitor_state_history_reset PASSED [ 96%]
tests/test_silent_issues.py::test_issue1_memory_veto_respects_escalation_priority PASSED [ 97%]
tests/test_skill_mode_integration.py::test_filter_crisp PASSED           [ 97%]
tests/test_skill_mode_integration.py::test_filter_balanced PASSED        [ 98%]
tests/test_skill_mode_integration.py::test_filter_hybrid PASSED          [ 98%]
tests/test_skill_mode_integration.py::test_invalid_mode PASSED           [ 99%]
tests/test_skill_mode_integration.py::test_runner_accepts_skill_mode PASSED [100%]

=============================== warnings summary ===============================
tests/test_balanced_runner.py:273
  /home/juancho/macgyver_mud/tests/test_balanced_runner.py:273: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_balanced_runner.py:279
  /home/juancho/macgyver_mud/tests/test_balanced_runner.py:279: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_balanced_runner.py:285
  /home/juancho/macgyver_mud/tests/test_balanced_runner.py:285: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_episodic_stress.py::test_overfitting_trap_stress_test
  /home/juancho/anaconda3/lib/python3.11/site-packages/_pytest/python.py:198: PytestReturnNotNoneWarning: Expected None, but tests/test_episodic_stress.py::test_overfitting_trap_stress_test returned {'num_counterfactuals': 40, 'overfitting_detected': False, 'max_concentration': 0.5}, which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

tests/test_episodic_stress.py::test_regret_spiral_stress_test
  /home/juancho/anaconda3/lib/python3.11/site-packages/_pytest/python.py:198: PytestReturnNotNoneWarning: Expected None, but tests/test_episodic_stress.py::test_regret_spiral_stress_test returned {'average_regret': 3.0, 'total_regret': 30, 'final_utility': 7.0, 'paralysis_detected': False}, which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

tests/test_episodic_stress.py::test_combined_stress_scenario
  /home/juancho/anaconda3/lib/python3.11/site-packages/_pytest/python.py:198: PytestReturnNotNoneWarning: Expected None, but tests/test_episodic_stress.py::test_combined_stress_scenario returned {'total_episodes': 5, 'total_counterfactuals': 50, 'system_functional': True}, which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 191 passed, 1 skipped, 6 warnings in 23.48s ==================
